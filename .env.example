# =============================================================================
# Backender Environment Configuration
# =============================================================================
# Copy this file to .env.local and fill in your values:
#   cp .env.example .env.local
#
# IMPORTANT: Never commit .env.local to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Docker Runtime (uncomment ONE based on your setup)
# -----------------------------------------------------------------------------
# For Colima:
# DOCKER_HOST=unix://${HOME}/.colima/default/docker.sock
# For Docker Desktop: (default, no need to set)
# DOCKER_HOST=unix:///var/run/docker.sock

# -----------------------------------------------------------------------------
# MySQL Database
# -----------------------------------------------------------------------------
MYSQL_HOST=mysql
MYSQL_USER=user
MYSQL_PASSWORD=your_mysql_password_here
MYSQL_DATABASE=mydb
MYSQL_ROOT_PASSWORD=your_root_password_here
MYSQL_PORT=3306

# Constructed from above values (do not modify directly)
DATABASE_URL=mysql://${MYSQL_USER}:${MYSQL_PASSWORD}@127.0.0.1:${MYSQL_PORT}/${MYSQL_DATABASE}

# -----------------------------------------------------------------------------
# Redis Cache
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
USER_API_PORT=3333
RUST_LOG=debug
ENV=local

# phpMyAdmin (for local development)
PHPMYADMIN_PORT=8082

# -----------------------------------------------------------------------------
# Elasticsearch (optional, for logging)
# -----------------------------------------------------------------------------
ELASTIC_HOST=elasticsearch
ELASTIC_PORT=9200
ELASTIC_URL=http://${ELASTIC_HOST}:${ELASTIC_PORT}

# -----------------------------------------------------------------------------
# API Middleware Configuration
# -----------------------------------------------------------------------------
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=150
REQUEST_TIMEOUT_SECS=30
CORS_ALLOWED_ORIGINS=*
MAX_BODY_SIZE_BYTES=1048576
SHUTDOWN_TIMEOUT_SECS=30

# IP Filtering (optional, comma-separated)
# IP_ALLOWLIST=192.168.1.1,10.0.0.1
# IP_BLOCKLIST=

# -----------------------------------------------------------------------------
# Database Pool Configuration (optional, uses defaults if not set)
# -----------------------------------------------------------------------------
# DB_MAX_CONNECTIONS=10
# DB_MIN_CONNECTIONS=1
# DB_ACQUIRE_TIMEOUT_SECS=5
# DB_IDLE_TIMEOUT_SECS=600
# DB_MAX_LIFETIME_SECS=1800

# -----------------------------------------------------------------------------
# Cache Configuration
# -----------------------------------------------------------------------------
CACHE_ENABLED=true
CACHE_USER_TTL_SECS=300
CACHE_ROLE_TTL_SECS=600
CACHE_LIST_TTL_SECS=60

# -----------------------------------------------------------------------------
# Secrets Management (Infisical)
# -----------------------------------------------------------------------------
# Configure Infisical for secure secrets management (optional)
# If not configured, the application will fall back to environment variables
# Run 'just setup-infisical' to automatically configure these values

# Infisical port for local Docker instance
INFISICAL_PORT=8888

# Infisical API URL (local Docker or Infisical Cloud: https://app.infisical.com)
INFISICAL_URL=http://localhost:8888

# Machine Identity credentials (generated by 'just setup-infisical')
# INFISICAL_CLIENT_ID=your_client_id
# INFISICAL_CLIENT_SECRET=your_client_secret

# Project and environment settings
# INFISICAL_PROJECT_ID=your_project_id
INFISICAL_ENVIRONMENT=dev

# Secret path (folder within project, defaults to "/")
# INFISICAL_SECRET_PATH=/

# Enable/disable secrets caching (default: true)
SECRETS_CACHE_ENABLED=true

# -----------------------------------------------------------------------------
# Keycloak Configuration
# -----------------------------------------------------------------------------
KEYCLOAK_URL=http://localhost:18080
KEYCLOAK_REALM=master
KEYCLOAK_CLIENT_ID=user-api-service

# IMPORTANT: This secret is generated by 'just setup-keycloak'
# Run 'just setup' to automatically configure this value
KEYCLOAK_CLIENT_SECRET=your_keycloak_client_secret_here

KEYCLOAK_PROFILE_CACHE_TTL_SECS=300

# -----------------------------------------------------------------------------
# Root User Configuration (created during 'just init-root')
# -----------------------------------------------------------------------------
ROOT_USER_EMAIL=root@mail.com
ROOT_USER_PASSWORD=your_secure_root_password_here
ROOT_USER_FIRST_NAME=Root
ROOT_USER_LAST_NAME=User
